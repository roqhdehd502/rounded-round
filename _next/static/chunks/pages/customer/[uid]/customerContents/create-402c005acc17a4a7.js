(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[83],{8869:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/customer/[uid]/customerContents/create",function(){return n(5594)}])},5594:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var r=n(7568),a=n(655),l=n(5893),c=n(7294),o=n(9473),u=n(4045),s=n.n(u),i=n(1163),m=n(1153),f=n(9403),d=n(6094),p=n(3386),h=n(8918),b=n(7632),g=n(8070);function v(){var e=(0,o.I0)(),t=(0,i.useRouter)(),n=(0,c.useState)(""),u=n[0],v=n[1],y=(0,c.useState)(""),E=y[0],N=y[1];(0,c.useEffect)(function(){},[t.query]);var j,x,w,_,O=function(e,t){for(var n=[],r=0;r<e.length;r++){for(var a=e[r].split(","),l=a[0].match(/:(.*?);/)[1],c=l.substring(6,l.length),o=atob(a[1]),u=o.length,s=new Uint8Array(u);u--;)s[u]=o.charCodeAt(u);n.push(new File([s],"".concat(t,"_").concat(r,".").concat(c),{type:l}))}return n},q=(j=(0,r.Z)(function(e,t,n,r){var l,c;return(0,a.__generator)(this,function(o){switch(o.label){case 0:l=function(l){var c;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return c=m.iH(e,"customercontentsimages/".concat(r,"/").concat(n,"/").concat(n,"_").concat(l)),[4,m.KV(c,t[l]).then(function(e){console.log("thumbnail images ".concat(l),e)}).catch(function(e){console.log("contents image upload error!",e)})];case 1:return a.sent(),[2]}})},c=0,o.label=1;case 1:if(!(c<t.length))return[3,4];return[5,(0,a.__values)(l(c))];case 2:o.sent(),o.label=3;case 3:return c++,[3,1];case 4:return[2]}})}),function(e,t,n,r){return j.apply(this,arguments)}),C=(x=(0,r.Z)(function(e,t,n,r){var l,c,o;return(0,a.__generator)(this,function(a){switch(a.label){case 0:l=[],c=0,a.label=1;case 1:if(!(c<t.length))return[3,4];return o=m.iH(e,"customercontentsimages/".concat(r,"/").concat(n,"/").concat(n,"_").concat(c)),[4,m.Jt(o).then(function(e){l.push(e)}).catch(function(e){console.log("contents image download error!",e)})];case 2:a.sent(),a.label=3;case 3:return c++,[3,1];case 4:return[2,l]}})}),function(e,t,n,r){return x.apply(this,arguments)}),L=(w=(0,r.Z)(function(t){var n,r,l,c,o,u,s,i,f,d;return(0,a.__generator)(this,function(a){switch(a.label){case 0:var p;if(n=m.cF(),r=(0,b.Z)(),l=document.querySelector("#photo-file").files[0],c=t.contents,p=t.contents,!(o=Array.from(p.matchAll(/<img[^>]+src=["']([^'">]+)['"]/gi)).map(function(e){return e.pop()||""})))return[3,3];return u=O(o,r),[4,q(n,u,r,t.uid)];case 1:return a.sent(),[4,C(n,u,r,t.uid)];case 2:for(i=0,s=a.sent();i<u.length;i++)c=c.replaceAll(o[i],s[i]);a.label=3;case 3:return f={uid:t.uid,title:t.title,contents:c,uploadDate:Date.now(),thumbnailUuid:r},l?(d=m.iH(n,"customercontentsimages/".concat(t.uid,"/").concat(r,"/").concat(r)),m.KV(d,l).then(function(t){console.log("thumbnail image",t),m.Jt(d).then(function(t){f.thumbnail=t,e((0,g.JH)(f))})}).catch(function(e){console.log("thumbnail image upload error!",e)})):(f.thumbnail="",e((0,g.JH)(f))),[2]}})}),function(e){return w.apply(this,arguments)}),P=(0,c.useCallback)((_=(0,r.Z)(function(e){return(0,a.__generator)(this,function(n){if(""===e.title||""===e.contents)return alert("제목 및 내용을 입력해주세요!"),[2];try{L(e).then(function(){t.replace("/customer/".concat(e.uid,"/customerContents"))}).catch(function(e){console.log(e)})}catch(r){console.log(r)}return[2]})}),function(e){return _.apply(this,arguments)}),[e]);return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"flex align-content-center align-items-center justify-content-center form-vertical-align-center",children:(0,l.jsxs)("div",{className:"card surface-0 p-5 border-round-2xl w-8",children:[(0,l.jsx)("h1",{className:"flex justify-content-center",children:"유저 컨텐츠 작성"}),(0,l.jsxs)("div",{className:"field p-fluid mt-6",children:[(0,l.jsx)("label",{children:"썸네일"}),(0,l.jsx)("span",{className:"p-inputgroup",children:(0,l.jsx)("input",{id:"photo-file",type:"file",accept:"image/*",placeholder:"이미지를 업로드 하세요"})})]}),(0,l.jsxs)("div",{className:"field p-fluid mt-6",children:[(0,l.jsx)("label",{children:"제목"}),(0,l.jsx)("span",{className:"p-inputgroup",children:(0,l.jsx)(d.o,{value:u,onChange:function(e){return v(e.target.value)}})})]}),(0,l.jsxs)("div",{className:"field p-fluid mt-6",children:[(0,l.jsx)("label",{children:"내용"}),(0,l.jsx)("span",{className:"p-inputgroup",children:(0,l.jsx)(p.M,{className:"h-30rem w-full",value:E,onTextChange:function(e){return N(e.htmlValue)}})})]}),(0,l.jsx)("div",{className:"field p-fluid mt-8",children:(0,l.jsx)(f.z,{label:"등록하기",icon:"pi pi-user-edit",className:"pr-5",onClick:function(){return P({uid:t.query.uid,title:u,contents:E})}})}),(0,l.jsx)(h.i,{}),(0,l.jsx)("div",{className:"field p-fluid",children:(0,l.jsx)(s(),{href:"/customer/".concat(t.query.uid,"/customerContents"),children:(0,l.jsx)(f.z,{label:"돌아가기",icon:"pi pi-arrow-left",className:"p-button-info pr-5"})})}),(0,l.jsx)("div",{className:"field p-fluid",children:(0,l.jsx)(s(),{href:"/",children:(0,l.jsx)(f.z,{label:"메인으로",icon:"pi pi-home",className:"p-button-info pr-5"})})})]})})})}v.layout="L1"},3386:function(e,t,n){"use strict";n.d(t,{M:function(){return i}});var r=n(7294),a=n(3308),l=n(3643);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var s=function(){try{return Quill}catch(e){return null}}(),i=r.memo(r.forwardRef(function(e,t){var m=r.useRef(null),f=r.useRef(null),d=r.useRef(null),p=r.useRef(null),h=r.useRef(!1);(0,a.nw)(function(){if(!h.current){var t={modules:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({toolbar:!!e.showHeader&&d.current},e.modules),placeholder:e.placeholder,readOnly:e.readOnly,theme:e.theme,formats:e.formats};s?(p.current=new Quill(f.current,t),b(),p.current&&p.current.getModule("toolbar")&&e.onLoad&&e.onLoad(p.current)):Promise.all([n.e(937),n.e(876)]).then(n.t.bind(n,6095,23)).then(function(e){e&&l.p7.isExist(f.current)&&(e.default?p.current=new e.default(f.current,t):p.current=new e(f.current,t),b())}).then(function(){p.current&&p.current.getModule("toolbar")&&e.onLoad&&e.onLoad(p.current)}),h.current=!0}});var b=function(){e.value&&p.current.setContents(p.current.clipboard.convert(e.value)),p.current.on("text-change",function(t,n,r){var a=f.current.children[0],c=a?a.innerHTML:null,o=p.current.getText();if("<p><br></p>"===c&&(c=null),"api"===r){var u=f.current.children[0],s=document.createElement("div");if(s.innerHTML=e.value||"",l.p7.isEqualElement(u,s))return}if(e.maxLength){var i=p.current.getLength();i>e.maxLength&&p.current.deleteText(e.maxLength,i)}e.onTextChange&&e.onTextChange({htmlValue:c,textValue:o,delta:t,source:r})}),p.current.on("selection-change",function(t,n,r){e.onSelectionChange&&e.onSelectionChange({range:t,oldRange:n,source:r})})};(0,a.rf)(function(){p.current&&!p.current.hasFocus()&&(e.value?p.current.setContents(p.current.clipboard.convert(e.value)):p.current.setText(""))},[e.value]),r.useImperativeHandle(t,function(){return{props:e,getQuill:function(){return p.current},getElement:function(){return m.current},getContent:function(){return f.current},getToolbar:function(){return d.current}}});var g=l.gb.findDiffKeys(e,i.defaultProps),v=(0,l.AK)("p-component p-editor-container",e.className),y=!1===e.showHeader?null:e.headerTemplate?r.createElement("div",{ref:d,className:"p-editor-toolbar"},e.headerTemplate):r.createElement("div",{ref:d,className:"p-editor-toolbar"},r.createElement("span",{className:"ql-formats"},r.createElement("select",{className:"ql-header",defaultValue:"0"},r.createElement("option",{value:"1"},"Heading"),r.createElement("option",{value:"2"},"Subheading"),r.createElement("option",{value:"0"},"Normal")),r.createElement("select",{className:"ql-font"},r.createElement("option",null),r.createElement("option",{value:"serif"}),r.createElement("option",{value:"monospace"}))),r.createElement("span",{className:"ql-formats"},r.createElement("button",{type:"button",className:"ql-bold","aria-label":"Bold"}),r.createElement("button",{type:"button",className:"ql-italic","aria-label":"Italic"}),r.createElement("button",{type:"button",className:"ql-underline","aria-label":"Underline"})),r.createElement("span",{className:"ql-formats"},r.createElement("select",{className:"ql-color"}),r.createElement("select",{className:"ql-background"})),r.createElement("span",{className:"ql-formats"},r.createElement("button",{type:"button",className:"ql-list",value:"ordered","aria-label":"Ordered List"}),r.createElement("button",{type:"button",className:"ql-list",value:"bullet","aria-label":"Unordered List"}),r.createElement("select",{className:"ql-align"},r.createElement("option",{defaultValue:!0}),r.createElement("option",{value:"center"}),r.createElement("option",{value:"right"}),r.createElement("option",{value:"justify"}))),r.createElement("span",{className:"ql-formats"},r.createElement("button",{type:"button",className:"ql-link","aria-label":"Insert Link"}),r.createElement("button",{type:"button",className:"ql-image","aria-label":"Insert Image"}),r.createElement("button",{type:"button",className:"ql-code-block","aria-label":"Insert Code Block"})),r.createElement("span",{className:"ql-formats"},r.createElement("button",{type:"button",className:"ql-clean","aria-label":"Remove Styles"}))),E=r.createElement("div",{ref:f,className:"p-editor-content",style:e.style});return r.createElement("div",c({id:e.id,ref:m,className:v},g),y,E)}));i.displayName="Editor",i.defaultProps={__TYPE:"Editor",id:null,value:null,style:null,className:null,placeholder:null,readOnly:!1,modules:null,formats:null,theme:"snow",showHeader:!0,headerTemplate:null,onTextChange:null,onSelectionChange:null,onLoad:null,maxLength:null}},7632:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});let r="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var a={randomUUID:r};let l,c=new Uint8Array(16);function o(){if(!l&&!(l="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return l(c)}let u=[];for(let s=0;s<256;++s)u.push((s+256).toString(16).slice(1));var i=function(e,t,n){if(a.randomUUID&&!t&&!e)return a.randomUUID();e=e||{};let r=e.random||(e.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let l=0;l<16;++l)t[n+l]=r[l];return t}return function(e,t=0){return(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase()}(r)}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=8869)}),_N_E=e.O()}]);